#!/usr/bin/pooscript
# warp_to_center - Set course toward galactic center

# Read current location
try:
    fd = kernel.open("/proc/ship/location", kernel.O_RDONLY)
    location_data = kernel.read(fd, 4096).decode('utf-8')
    kernel.close(fd)
except Exception as e:
    error(f"Failed to read location: {e}")
    exit(1)

# Extract current position
current_pos = 0.0
for line in location_data.split('\n'):
    if "Position:" in line and "units from center" in line:
        try:
            current_pos = float(line.split(':')[1].strip().split()[0])
        except:
            pass

# Set course to center (position 0)
try:
    fd = kernel.open("/dev/ship/course", kernel.O_WRONLY)
    kernel.write(fd, b"0")
    kernel.close(fd)

    print(f"âœ“ Course set to galactic center")
    print(f"  Current position: {current_pos:.1f}")
    print(f"  Destination: 0.0 (center)")
    print(f"  Distance: {current_pos:.1f} units")
except Exception as e:
    error(f"Failed to set course: {e}")
    exit(1)
